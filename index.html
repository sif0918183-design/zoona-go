<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ±Ø­Ø§Ù„ Ø²ÙˆÙ†Ø§ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† - Tarhal</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4f46e5">
    <link rel="icon" href="icons/icon-192x192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- Tajawal Font -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Ionicons Icons -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --primary-light: #e0e7ff;
            --secondary: #10b981;
            --secondary-dark: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --light: #f9fafb;
            --dark: #111827;
            --gray: #6b7280;
            --gray-light: #e5e7eb;
            
            --driver: #16a34a;
            --tuk-tuk: #059669;
            --economy: #2563eb;
            --comfort: #7c3aed;
            --vip: #d97706;
            --staff: #7c3aed;
            
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            --radius: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .app-container {
            max-width: 500px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--light);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px 24px;
            text-align: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 4px solid var(--primary-dark);
        }
        
        .app-header h1 {
            font-size: 24px;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .app-header .logo {
            font-size: 28px;
        }
        
        /* Screens */
        .screen {
            padding: 24px;
            min-height: calc(100vh - 76px);
            display: flex;
            flex-direction: column;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Cards */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 24px;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 16px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        /* Buttons */
        .btn {
            padding: 16px 24px;
            border-radius: var(--radius);
            border: none;
            font-family: 'Tajawal', sans-serif;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            margin-bottom: 12px;
        }
        
        .btn:active {
            transform: translateY(2px);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.3);
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-secondary:hover {
            background: var(--secondary-dark);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
        }
        
        .btn-driver {
            background: var(--driver);
            color: white;
        }
        
        .btn-driver:hover {
            background: #15803d;
            box-shadow: 0 6px 20px rgba(22, 163, 74, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary-light);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: var(--danger-dark);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.3);
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
            font-size: 14px;
        }
        
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-light);
            border-radius: var(--radius);
            font-family: 'Tajawal', sans-serif;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .form-input::placeholder {
            color: var(--gray);
        }
        
        /* Welcome Screen */
        .welcome-card {
            text-align: center;
            padding: 40px 24px;
            background: linear-gradient(135deg, #e0e7ff 0%, #ede9fe 100%);
            border: none;
            margin-top: 40px;
        }
        
        .welcome-icon {
            font-size: 64px;
            margin-bottom: 24px;
            color: var(--primary);
        }
        
        .welcome-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 12px;
        }
        
        .welcome-subtitle {
            color: var(--gray);
            font-size: 16px;
            margin-bottom: 40px;
            line-height: 1.6;
        }
        
        .role-selection {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .role-card {
            background: white;
            border-radius: var(--radius);
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            text-align: right;
        }
        
        .role-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }
        
        .role-icon {
            font-size: 32px;
            color: var(--primary);
        }
        
        .role-info h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--dark);
        }
        
        .role-info p {
            font-size: 14px;
            color: var(--gray);
            line-height: 1.5;
        }
        
        /* Login Screens */
        .login-form {
            max-width: 400px;
            margin: 0 auto;
            width: 100%;
        }
        
        .form-footer {
            text-align: center;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
        }
        
        .form-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
.form-footer .register-text {
    margin-bottom: 20px; /* Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø²Ø±ÙŠÙ† */
}

.form-footer .register-text a {
    display: inline; /* ÙŠØ¨Ù‚Ù‰ ÙƒÙ†Øµ */
}

.form-footer .back-link {
    display: inline-flex;
    justify-content: center;
    margin-top: 8px;
    padding: 10px 16px;
    border-radius: 12px;
    background: #f1f2ff;
    font-size: 14px;
}
        
        .form-footer a:hover {
            text-decoration: underline;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            left: 20px;
            right: 20px;
            background: white;
            border-radius: var(--radius);
            padding: 16px;
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
            border-right: 4px solid var(--primary);
            animation: slideIn 0.3s ease;
            max-width: 500px;
            margin: 0 auto;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .notification-icon {
            font-size: 24px;
        }
        
        .notification-success {
            border-right-color: var(--secondary);
        }
        
        .notification-error {
            border-right-color: var(--danger);
        }
        
        .notification-warning {
            border-right-color: var(--warning);
        }
        
        /* Overlay Modals */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal {
            background: white;
            border-radius: var(--radius-xl);
            padding: 32px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(40px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 24px;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 8px;
        }
        
        .modal-subtitle {
            color: var(--gray);
            font-size: 16px;
        }
        
        /* Home Screen */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 32px;
        }
        
        .user-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 700;
        }
        
        .user-info h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--dark);
        }
        
        .user-info p {
            color: var(--gray);
            font-size: 14px;
        }
        
        .verified-badge {
            background: var(--secondary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .home-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-top: 20px;
        }
        
        .action-card {
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--gray-light);
        }
        
        .action-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
            border-color: var(--primary-light);
        }
        
        .action-icon {
            font-size: 32px;
            margin-bottom: 12px;
            color: var(--primary);
        }
        
        .action-card h4 {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark);
        }
        
        /* Ride Request */
        .map-container {
            width: 100%;
            height: 250px;
            border-radius: var(--radius);
            overflow: hidden;
            margin-bottom: 24px;
            border: 2px solid var(--gray-light);
        }
        
        .vehicle-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .vehicle-option {
            border: 2px solid var(--gray-light);
            border-radius: var(--radius);
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .vehicle-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .vehicle-option.selected {
            border-color: var(--primary);
            background: var(--primary-light);
        }
        
        .vehicle-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .vehicle-name {
            font-weight: 700;
            margin-bottom: 4px;
            font-size: 14px;
        }
        
        .vehicle-price {
            color: var(--primary);
            font-weight: 800;
            font-size: 18px;
        }
        
        .price-breakdown {
            background: var(--light);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 24px;
        }
        
        .price-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .price-row:last-child {
            border-bottom: none;
            font-weight: 800;
            font-size: 20px;
            color: var(--primary);
        }
        
        /* Driver Dashboard */
        .driver-status {
            background: var(--light);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 24px;
            text-align: center;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .status-offline {
            background: #fee2e2;
            color: var(--danger);
        }
        
        .status-online {
            background: #dcfce7;
            color: var(--secondary-dark);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .status-offline .status-dot {
            background: var(--danger);
        }
        
        .status-online .status-dot {
            background: var(--secondary);
        }
        
        .driver-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--radius);
            padding: 16px;
            text-align: center;
            border: 1px solid var(--gray-light);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--gray);
        }
        
        /* Responsive */
        @media (max-width: 480px) {
            .screen {
                padding: 16px;
            }
            
            .card {
                padding: 20px;
            }
            
            .vehicle-options {
                grid-template-columns: 1fr;
            }
            
            .home-actions {
                grid-template-columns: 1fr;
            }
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Utility Classes */
        .text-center { text-align: center; }
        .mb-1 { margin-bottom: 8px; }
        .mb-2 { margin-bottom: 16px; }
        .mb-3 { margin-bottom: 24px; }
        .mt-1 { margin-top: 8px; }
        .mt-2 { margin-top: 16px; }
        .mt-3 { margin-top: 24px; }
        .p-1 { padding: 8px; }
        .p-2 { padding: 16px; }
        .p-3 { padding: 24px; }
        
        /* PWA Install Prompt */
        #pwa-install-prompt {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: white;
            padding: 16px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            animation: slideUp 0.3s ease;
        }
        
        .pwa-mode .app-header {
            padding-top: env(safe-area-inset-top, 20px);
        }
.app-title {
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo-img {
    width: 70px;
    height: 70px;
    object-fit: contain;
}
    </style>
</head>
<body>
    <div class="app-container">
    <!-- Header -->
    <header class="app-header">
        <h1 class="app-title">
            <img 
                src="icons/icon-512x512.png" 
                alt="ØªØ±Ø­Ø§Ù„ Ø²ÙˆÙ†Ø§ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†" 
                class="logo-img"
            >
            ØªØ±Ø­Ù€Ù€Ø§Ù„ Ø²ÙˆÙ†Ù€Ù€Ø§
        </h1>
    </header>
        
        <!-- Welcome Screen -->
<section id="welcome-screen" class="screen">
    <div class="welcome-card card">

        <h1 class="welcome-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØªØ±Ø­Ø§Ù„ Ø²ÙˆÙ†Ø§</h1>
        <p class="welcome-subtitle">
            ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†. Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù„Ø¨Ø¯Ø¡
        </p>
        
        <div class="role-selection">

            <!-- Ø·Ø§Ù„Ø¨ Ø±Ø­Ù„Ø© -->
            <div class="role-card" onclick="showCustomerLogin()">
                <div class="role-icon">
                    <i class="fa-solid fa-user"></i>
                </div>
                <div class="role-info">
                    <h3>Ø·Ø§Ù„Ø¨ Ø±Ø­Ù„Ø©</h3>
                    <p>Ø§Ø·Ù„Ø¨ Ø±Ø­Ù„Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù† Ù…Ù† Ø£Ù‚Ø±Ø¨ Ø³Ø§Ø¦Ù‚ Ù„Ùƒ</p>
                </div>
                <ion-icon name="chevron-forward-outline"></ion-icon>
            </div>

            <!-- Ø³Ø§Ø¦Ù‚ -->
            <div class="role-card" onclick="showDriverLogin()">
                <div class="role-icon">
                    <i class="fa-solid fa-car"></i>
                </div>
                <div class="role-info">
                    <h3>Ø³Ø§Ø¦Ù‚</h3>
                    <p>Ø§Ù†Ø¶Ù… ÙƒØ³Ø§Ø¦Ù‚ ÙˆØ§Ø¨Ø¯Ø£ ÙƒØ³Ø¨ Ø§Ù„Ù…Ø§Ù„ Ù…Ø¹ ØªØ±Ø­Ø§Ù„ Ø²ÙˆÙ†Ø§</p>
                </div>
                <ion-icon name="chevron-forward-outline"></ion-icon>
            </div>

            <div class="form-footer mt-3">
                <a href="/admin-login.html">
                    <ion-icon name="shield-checkmark-outline"></ion-icon>
                    Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†
                </a>
            </div>

        </div>
    </div>
</section>
        
        <!-- Customer Login -->
        <section id="customer-login-screen" class="screen hidden">
            <div class="card">
                <h2 class="card-title">
                    <ion-icon name="person-circle-outline"></ion-icon>
                    Ø¯Ø®ÙˆÙ„ Ø·Ø§Ù„Ø¨ Ø§Ù„Ø±Ø­Ù„Ø©
                </h2>
                
                <form class="login-form" id="customerLoginForm">
                    <div class="form-group">
                        <label class="form-label" for="customer-phone">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
                        <input type="tel" id="customer-phone" class="form-input" 
                               placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="customer-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="customer-password" class="form-input" 
                               placeholder="Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
                    </div>
                    
                    <button type="button" class="btn btn-primary" onclick="loginCustomer()">
                        <ion-icon name="log-in-outline"></ion-icon>
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </button>
                </form>
                
                <div class="form-footer">
    <p class="register-text">
        Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ
        <a href="#" onclick="showCustomerRegister()">Ø³Ø¬Ù„ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¢Ù†</a>
    </p>

    <a href="#" class="back-link" onclick="showWelcomeScreen()">
        <ion-icon name="arrow-back-outline"></ion-icon>
        Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª
    </a>
</div>
            </div>
        </section>
        
        <!-- Customer Registration -->
        <section id="customer-register-screen" class="screen hidden">
            <div class="card">
                <h2 class="card-title">
                    <ion-icon name="person-add-outline"></ion-icon>
                    ØªØ³Ø¬ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
                </h2>
                
                <form class="login-form" id="customerRegisterForm">
                    <div class="form-group">
                        <label class="form-label" for="register-fullname">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ</label>
                        <input type="text" id="register-fullname" class="form-input" 
                               placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="register-phone">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</label>
                        <input type="tel" id="register-phone" class="form-input" 
                               placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ (Ù„Ù„ØªØ³Ø¬ÙŠÙ„)" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="register-phone2">Ø±Ù‚Ù… Ø¥Ø¶Ø§ÙÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="tel" id="register-phone2" class="form-input" 
                               placeholder="Ø±Ù‚Ù… Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„ØªÙˆØ§ØµÙ„">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="register-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="register-password" class="form-input" 
                               placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©" required>
                    </div>
                    
                    <button type="button" class="btn btn-primary" onclick="registerCustomer()">
                        <ion-icon name="create-outline"></ion-icon>
                        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨
                    </button>
                </form>
                
                <div id="verification-section" class="hidden mt-3">
                    <div class="card" style="background: #f0f9ff; border: 2px dashed var(--secondary);">
                        <h3 class="mb-2" style="color: var(--secondary);">
                            <ion-icon name="checkmark-circle-outline"></ion-icon>
                            ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!
                        </h3>
                        <p class="mb-2">Ù„ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨ÙƒØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯:</p>
                        
                        <button type="button" class="btn btn-secondary" onclick="sendVerificationWhatsApp()">
                            <ion-icon name="logo-whatsapp"></ion-icon>
                            ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
                        </button>
                        
                        <p class="mt-2" style="font-size: 14px; color: var(--gray);">
                            Ø¨Ø¹Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŒ Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø®Ù„Ø§Ù„ Ø¯Ù‚Ø§Ø¦Ù‚
                        </p>
                    </div>
                </div>
                
                <div class="form-footer mt-3">
                    <a href="#" onclick="showCustomerLogin()">
                        <ion-icon name="arrow-back-outline"></ion-icon>
                        Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </a>
                </div>
            </div>
        </section>
        
        <!-- Driver Login -->
        <section id="driver-login-screen" class="screen hidden">
            <div class="card">
                <h2 class="card-title">
                    <ion-icon name="car-sport-outline"></ion-icon>
                    Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†
                </h2>
                
                <form class="login-form" id="driverLoginForm">
                    <div class="form-group">
                        <label class="form-label" for="driver-phone">Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
                        <input type="tel" id="driver-phone" class="form-input" 
                               placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="driver-password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" id="driver-password" class="form-input" 
                               placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø³Ø§Ø¦Ù‚" required>
                    </div>
                    
                    <button type="button" class="btn btn-driver" onclick="loginDriver()">
                        <ion-icon name="log-in-outline"></ion-icon>
                        Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚
                    </button>
                </form>
                
                <div class="form-footer">
                    <p>Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø³Ø§Ø¦Ù‚ØŸ 
                        <a href="#" onclick="showDriverRegisterInfo()">Ø³Ø¬Ù„ ÙƒØ³Ø§Ø¦Ù‚ Ø§Ù„Ø¢Ù†</a>
                    </p>
                    <a href="#" onclick="showWelcomeScreen()">
                        <ion-icon name="arrow-back-outline"></ion-icon>
                        Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª
                    </a>
                </div>
            </div>
        </section>
        
        <!-- Driver Registration Info -->
        <section id="driver-register-info-screen" class="screen hidden">
            <div class="card">
                <h2 class="card-title">
                    <ion-icon name="information-circle-outline"></ion-icon>
                    Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙƒØ³Ø§Ø¦Ù‚
                </h2>
                
                <div class="mb-3">
                    <p>Ù„Ù„ØªØ³Ø¬ÙŠÙ„ ÙƒØ³Ø§Ø¦Ù‚ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ ØªØ±Ø­Ø§Ù„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø¥Ø¯Ø§Ø±ØªÙ†Ø§ Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</p>
                    
                    <div class="p-3" style="background: #f0f9ff; border-radius: var(--radius); margin: 20px 0;">
                        <h4 class="mb-2" style="color: var(--primary);">Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</h4>
                        <ul style="padding-right: 20px; line-height: 1.8;">
                            <li>Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø³Ø§Ø±ÙŠØ©</li>
                            <li>Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</li>
                            <li>ØµÙˆØ±Ø© Ø´Ø®ØµÙŠØ©</li>
                            <li>ØµÙˆØ±Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ù† Ø§Ù„Ø®Ø§Ø±Ø¬</li>
                            <li>ØµÙˆØ±Ø© Ù„ÙˆØ­Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</li>
                        </ul>
                    </div>
                </div>
                
                <button type="button" class="btn btn-driver" onclick="contactAdminForDriverRegistration()">
                    <ion-icon name="logo-whatsapp"></ion-icon>
                    Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨
                </button>
                
                <div class="form-footer mt-3">
                    <a href="#" onclick="showDriverLogin()">
                        <ion-icon name="arrow-back-outline"></ion-icon>
                        Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </a>
                </div>
            </div>
        </section>
        
        <!-- Home Screen (After Login) -->
        <section id="home-screen" class="screen hidden">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar">?</div>
                <div class="user-info">
                    <h3 id="user-name">Ù…Ø±Ø­Ø¨Ø§Ù‹</h3>
                    <p id="user-phone-display"></p>
                    <div id="verification-status" class="hidden mt-1">
                        <span class="verified-badge">
                            <ion-icon name="checkmark-circle"></ion-icon>
                            Ø­Ø³Ø§Ø¨ Ù…ÙˆØ«Ù‚
                        </span>
                    </div>
                </div>
            </div>
            
            <div class="home-actions">
                <div class="action-card" onclick="requestRide()">
                    <div class="action-icon">ğŸš–</div>
                    <h4>Ø·Ù„Ø¨ Ø±Ø­Ù„Ø©</h4>
                </div>
                
                <div class="action-card" onclick="showMyRides()">
                    <div class="action-icon">ğŸ“‹</div>
                    <h4>Ø±Ø­Ù„Ø§ØªÙŠ</h4>
                </div>
                
                <div class="action-card" onclick="showWallet()">
                    <div class="action-icon">ğŸ’°</div>
                    <h4>Ø§Ù„Ù…Ø­ÙØ¸Ø©</h4>
                </div>
                
                <div class="action-card" onclick="showSettings()">
                    <div class="action-icon">âš™ï¸</div>
                    <h4>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h4>
                </div>
            </div>
            
            <button class="btn btn-outline mt-3" onclick="logout()">
                <ion-icon name="log-out-outline"></ion-icon>
                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
        </section>
        
        <!-- Ride Request Screen -->
        <section id="ride-request-screen" class="screen hidden">
            <div class="card">
                <h2 class="card-title">
                    <ion-icon name="navigate-outline"></ion-icon>
                    Ø·Ù„Ø¨ Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
                </h2>
                
                <div class="map-container" id="ride-map">
                    <!-- Ø³ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù‡Ù†Ø§ -->
                </div>
                
                <div class="mb-3">
                    <h4 class="form-label">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©:</h4>
                    <div class="vehicle-options">
                        <div class="vehicle-option" data-type="tuktuk" onclick="selectVehicle('tuktuk')">
                            <div class="vehicle-icon">ğŸ›º</div>
                            <div class="vehicle-name">ØªÙˆÙƒ ØªÙˆÙƒ</div>
                            <div class="vehicle-price">5,000 SDG</div>
                        </div>
                        
                        <div class="vehicle-option" data-type="economy" onclick="selectVehicle('economy')">
                            <div class="vehicle-icon">ğŸš—</div>
                            <div class="vehicle-name">Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©</div>
                            <div class="vehicle-price">6,000 SDG</div>
                        </div>
                        
                        <div class="vehicle-option" data-type="comfort" onclick="selectVehicle('comfort')">
                            <div class="vehicle-icon">ğŸš™</div>
                            <div class="vehicle-name">Ù…ØªÙˆØ³Ø·Ø©</div>
                            <div class="vehicle-price">7,000 SDG</div>
                        </div>
                        
                        <div class="vehicle-option" data-type="vip" onclick="selectVehicle('vip')">
                            <div class="vehicle-icon">â­</div>
                            <div class="vehicle-name">VIP</div>
                            <div class="vehicle-price">10,000 SDG</div>
                        </div>
                    </div>
                </div>
                
                <div id="price-calculation" class="price-breakdown hidden">
                    <div class="price-row">
                        <span>Ø§Ù„Ù…Ø³Ø§ÙØ©:</span>
                        <span id="distance-display">0 ÙƒÙ…</span>
                    </div>
                    <div class="price-row">
                        <span>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:</span>
                        <span id="base-price-display">0 SDG</span>
                    </div>
                    <div class="price-row">
                        <span>Ø±Ø³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ©:</span>
                        <span id="extra-price-display">0 SDG</span>
                    </div>
                    <div class="price-row">
                        <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
                        <span id="total-price-display">0 SDG</span>
                    </div>
                </div>
                
                <button id="confirm-ride-btn" class="btn btn-primary" onclick="confirmRide()" disabled>
                    <ion-icon name="search-outline"></ion-icon>
                    Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¦Ù‚
                </button>
                
                <button class="btn btn-outline mt-2" onclick="goHome()">
                    <ion-icon name="arrow-back-outline"></ion-icon>
                    Ø¥Ù„ØºØ§Ø¡ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø©
                </button>
            </div>
        </section>
        
        <!-- Driver Dashboard -->
        <section id="driver-dashboard-screen" class="screen hidden">
            <div class="card">
                <div class="user-profile">
                    <div class="user-avatar" id="driver-avatar">?</div>
                    <div class="user-info">
                        <h3 id="driver-name">Ø³Ø§Ø¦Ù‚</h3>
                        <p id="driver-car-info">Ù…Ø±ÙƒØ¨Ø©</p>
                    </div>
                </div>
                
                <div class="driver-status">
                    <div id="driver-status-indicator" class="status-indicator status-offline">
                        <span class="status-dot"></span>
                        <span id="driver-status-text">ØºÙŠØ± Ù…ØªØµÙ„</span>
                    </div>
                    
                    <button id="toggle-online-btn" class="btn btn-driver" onclick="toggleDriverStatus()">
                        <ion-icon name="power-outline"></ion-icon>
                        ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù…Ù„
                    </button>
                </div>
                
                <div class="driver-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="driver-balance">0</div>
                        <div class="stat-label">Ø±ØµÙŠØ¯Ùƒ (SDG)</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="today-trips">0</div>
                        <div class="stat-label">Ø±Ø­Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="today-earnings">0</div>
                        <div class="stat-label">Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="total-trips">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø­Ù„Ø§Øª</div>
                    </div>
                </div>
                
                <button class="btn btn-outline" onclick="showDriverProfile()">
                    <ion-icon name="person-outline"></ion-icon>
                    Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                </button>
                
                <button class="btn btn-outline mt-2" onclick="logoutDriver()">
                    <ion-icon name="log-out-outline"></ion-icon>
                    ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„Ø³Ø§Ø¦Ù‚
                </button>
            </div>
        </section>
    </div>
    
    <!-- PWA Install Prompt -->
    <div id="pwa-install-prompt" style="display: none; position: fixed; bottom: 20px; left: 20px; right: 20px; background: white; padding: 16px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000;">
        <div style="text-align: center;">
            <h4 style="margin-bottom: 8px; color: var(--primary);">ØªØ«Ø¨ÙŠØª ØªØ·Ø¨ÙŠÙ‚ ØªØ±Ø­Ø§Ù„</h4>
            <p style="margin-bottom: 16px; color: var(--gray); font-size: 14px;">
                Ø«Ø¨Ù‘Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª ÙˆØ¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙˆØ±ÙŠØ©
            </p>
            <div style="display: flex; gap: 8px;">
                <button onclick="installPWA()" style="flex: 1; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; font-family: 'Tajawal'; font-weight: 700;">
                    ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¢Ù†
                </button>
                <button onclick="hideInstallPrompt()" style="flex: 1; padding: 12px; background: transparent; color: var(--gray); border: 1px solid var(--gray-light); border-radius: 8px; font-family: 'Tajawal';">
                    Ù„Ø§Ø­Ù‚Ø§Ù‹
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="notification-area"></div>
    
    <!-- Ride Request Modal (For Driver) -->
    <div id="incoming-ride-modal" class="overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <div style="font-size: 48px; margin-bottom: 16px;">ğŸš¨</div>
                <h2 class="modal-title">Ø·Ù„Ø¨ Ø±Ø­Ù„Ø© Ø¬Ø¯ÙŠØ¯!</h2>
                <p class="modal-subtitle">Ù„Ø¯ÙŠÙƒ 40 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø±Ø¯</p>
            </div>
            
            <div class="card" style="background: #fef2f2;">
                <div id="ride-details">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø­Ù„Ø© Ù‡Ù†Ø§ -->
                </div>
            </div>
            
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-driver" onclick="acceptRide()" style="flex: 1;">
                    <ion-icon name="checkmark-outline"></ion-icon>
                    Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø±Ø­Ù„Ø©
                </button>
                <button class="btn btn-danger" onclick="declineRide()" style="flex: 1;">
                    <ion-icon name="close-outline"></ion-icon>
                    Ø±ÙØ¶
                </button>
            </div>
            
            <div class="countdown" style="text-align: center; font-size: 32px; font-weight: 800; color: var(--danger); margin-top: 20px;">
                40
            </div>
        </div>
    </div>
    
    <!-- Active Trip Modal -->
    <div id="active-trip-modal" class="overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <div style="font-size: 48px; margin-bottom: 16px;">ğŸš—</div>
                <h2 class="modal-title">Ø§Ù„Ø±Ø­Ù„Ø© Ø³Ø§Ø±ÙŠØ© Ø§Ù„Ø¢Ù†</h2>
            </div>
            
            <div id="trip-details">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø­Ù„Ø© Ù‡Ù†Ø§ -->
            </div>
        </div>
    </div>

    <script>
        // --- Supabase Configuration ---
        const SB_URL = 'https://zsmlyiygjagmhnglrhoa.supabase.co';
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpzbWx5aXlnamFnbWhuZ2xyaG9hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5NDc3NjMsImV4cCI6MjA4MTUyMzc2M30.QviVinAng-ILq0umvI5UZCFEvNpP3nI0kW_hSaXxNps';
        
        // Ø§Ù„ØªØµØ­ÙŠØ­: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù Ø¹Ù† supabase
        const tarhalDB = supabase.createClient(SB_URL, SB_KEY);
        
        // --- Application State ---
        let currentUser = null;
        let currentDriver = null;
        let isDriverOnline = false;
        let selectedVehicleType = null;
        let rideMap = null;
        let userMarker = null;
        let destinationMarker = null;
        let userPosition = null;
        let destinationPosition = null;
        let currentRideId = null;
        let rideCountdownInterval = null;
        let rideTimeout = 40;
        let registeredPhone = null;
        let deferredPrompt = null; // Ù„ØªØ­ÙƒÙ… PWA
        
        // Vehicle prices
        const VEHICLE_PRICES = {
            tuktuk: { base: 5000, perKm: 2000, name: 'ØªÙˆÙƒ ØªÙˆÙƒ', icon: 'ğŸ›º' },
            economy: { base: 6000, perKm: 3000, name: 'Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©', icon: 'ğŸš—' },
            comfort: { base: 7000, perKm: 3500, name: 'Ù…ØªÙˆØ³Ø·Ø©', icon: 'ğŸš™' },
            vip: { base: 10000, perKm: 5000, name: 'VIP', icon: 'â­' }
        };
        
        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            initServiceWorker();
            initPWAEvents();
            testPWACompatibility();
        });
        
        // --- PWA Functions ---
        function initServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js', { 
                    scope: './' 
                })
                .then(registration => {
                    console.log('Service Worker registered with scope:', registration.scope);
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØªØ­Ø¯ÙŠØ«
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('New Service Worker found!');
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('New content is available; please refresh.');
                                showNotification('ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙŠØ¯ Ù…ØªØ§Ø­. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©', 'info');
                            }
                        });
                    });
                })
                .catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
            }
        }
        
        function initPWAEvents() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Ø¹Ø±Ø¶ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
                setTimeout(() => {
                    if (deferredPrompt) {
                        showInstallPrompt();
                    }
                }, 5000);
            });
            
            window.addEventListener('appinstalled', () => {
                console.log('PWA was installed');
                localStorage.setItem('pwa_installed', 'true');
                showNotification('ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            });
            
            // Check for updates every hour
            if ('serviceWorker' in navigator) {
                setInterval(() => {
                    navigator.serviceWorker.getRegistration()
                        .then(registration => {
                            if (registration) {
                                registration.update();
                            }
                        });
                }, 60 * 60 * 1000);
            }
        }
        
        function showInstallPrompt() {
            const prompt = document.getElementById('pwa-install-prompt');
            if (prompt) {
                prompt.style.display = 'block';
            }
        }
        
        function hideInstallPrompt() {
            const prompt = document.getElementById('pwa-install-prompt');
            if (prompt) {
                prompt.style.display = 'none';
            }
        }
        
        async function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    showNotification('ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                }
                
                deferredPrompt = null;
                hideInstallPrompt();
            }
        }
        
        function testPWACompatibility() {
            const tests = {
                'serviceWorker': 'serviceWorker' in navigator,
                'localStorage': 'localStorage' in window,
                'geolocation': 'geolocation' in navigator,
                'notifications': 'Notification' in window,
                'installPrompt': 'onbeforeinstallprompt' in window,
                'standalone': window.matchMedia('(display-mode: standalone)').matches
            };
            
            console.log('PWA Compatibility Test:');
            Object.keys(tests).forEach(test => {
                console.log(`${test}: ${tests[test] ? 'âœ…' : 'âŒ'}`);
            });
            
            // Check if app is running as PWA
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('App is running as standalone PWA');
                document.body.classList.add('pwa-mode');
            }
        }
        
        function checkAuth() {
            const savedUser = localStorage.getItem('tarhal_customer');
            const savedDriver = localStorage.getItem('tarhal_driver');
            
            if (savedDriver) {
                try {
                    currentDriver = JSON.parse(savedDriver);
                    showScreen('driver-dashboard-screen');
                    updateDriverDashboard();
                } catch (e) {
                    localStorage.removeItem('tarhal_driver');
                    showScreen('welcome-screen');
                }
            } else if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    showScreen('home-screen');
                    updateUserProfile();
                } catch (e) {
                    localStorage.removeItem('tarhal_customer');
                    showScreen('welcome-screen');
                }
            } else {
                showScreen('welcome-screen');
            }
        }
        
        // --- Screen Navigation ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }
        
        function showWelcomeScreen() {
            showScreen('welcome-screen');
        }
        
        function showCustomerLogin() {
            showScreen('customer-login-screen');
            document.getElementById('customer-phone').focus();
        }
        
        function showCustomerRegister() {
            showScreen('customer-register-screen');
            document.getElementById('verification-section').classList.add('hidden');
            document.getElementById('register-fullname').focus();
            // ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            document.getElementById('customerRegisterForm').style.opacity = '1';
            document.querySelector('#customerRegisterForm button').disabled = false;
        }
        
        function showDriverLogin() {
            showScreen('driver-login-screen');
            document.getElementById('driver-phone').focus();
        }
        
        function showDriverRegisterInfo() {
            showScreen('driver-register-info-screen');
        }
        
        function goHome() {
            if (currentUser) {
                showScreen('home-screen');
            } else if (currentDriver) {
                showScreen('driver-dashboard-screen');
            } else {
                showScreen('welcome-screen');
            }
        }
        
        // --- Customer Functions ---
        async function loginCustomer() {
            const phone = document.getElementById('customer-phone').value.trim();
            const password = document.getElementById('customer-password').value;
            
            if (!phone || !password) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙŠØºØ© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ
            if (!isValidSudanesePhone(phone)) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø³ÙˆØ¯Ø§Ù†ÙŠ ØµØ­ÙŠØ­', 'error');
                return;
            }
            
            const loginBtn = document.querySelector('#customerLoginForm button');
            const originalText = loginBtn.innerHTML;
            loginBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
            loginBtn.disabled = true;
            
            try {
                const { data: customer, error } = await tarhalDB
                    .from('customers')
                    .select('*')
                    .eq('phone', phone)
                    .single();
                
                if (error) {
                    showNotification('Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ØºÙŠØ± Ù…Ø³Ø¬Ù„', 'error');
                    loginBtn.innerHTML = originalText;
                    loginBtn.disabled = false;
                    return;
                }
                
                if (customer.password !== password) {
                    showNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                    loginBtn.innerHTML = originalText;
                    loginBtn.disabled = false;
                    return;
                }
                
                if (!customer.is_verified) {
                    showNotification('Ø­Ø³Ø§Ø¨Ùƒ ØºÙŠØ± Ù…ÙØ¹Ù„. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', 'warning');
                    loginBtn.innerHTML = originalText;
                    loginBtn.disabled = false;
                    
                    // Ø¥Ø¸Ù‡Ø§Ø± Ø®ÙŠØ§Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
                    setTimeout(() => {
                        if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©ØŸ')) {
                            sendVerificationWhatsApp(customer.phone);
                        }
                    }, 2000);
                    return;
                }
                
                currentUser = customer;
                localStorage.setItem('tarhal_customer', JSON.stringify(customer));
                
                showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                showScreen('home-screen');
                updateUserProfile();
                
            } catch (error) {
                console.error('Login error:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„', 'error');
            } finally {
                loginBtn.innerHTML = originalText;
                loginBtn.disabled = false;
            }
        }
        
        async function registerCustomer() {
            const fullname = document.getElementById('register-fullname').value.trim();
            const phone = document.getElementById('register-phone').value.trim();
            const phone2 = document.getElementById('register-phone2').value.trim();
            const password = document.getElementById('register-password').value;
            
            if (!fullname || !phone || !password) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
            
            // Validate phone number (Sudanese format)
            if (!isValidSudanesePhone(phone)) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø³ÙˆØ¯Ø§Ù†ÙŠ ØµØ­ÙŠØ­', 'error');
                return;
            }
            
            const registerBtn = document.querySelector('#customerRegisterForm button');
            const originalText = registerBtn.innerHTML;
            registerBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...';
            registerBtn.disabled = true;
            
            try {
                // Check if phone already exists
                const { data: existingCustomer, error: checkError } = await tarhalDB
                    .from('customers')
                    .select('id')
                    .eq('phone', phone)
                    .single();
                
                if (existingCustomer) {
                    showNotification('Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„', 'error');
                    registerBtn.innerHTML = originalText;
                    registerBtn.disabled = false;
                    return;
                }
                
                // Register new customer
                const { data: newCustomer, error } = await tarhalDB
                    .from('customers')
                    .insert([{
                        full_name: fullname,
                        phone: phone,
                        phone2: phone2 || null,
                        password: password,
                        is_verified: false,
                        created_at: new Date().toISOString()
                    }])
                    .select()
                    .single();
                
                if (error) throw error;
                
                // Store phone for verification
                registeredPhone = phone;
                
                // Show verification section
                document.getElementById('verification-section').classList.remove('hidden');
                document.getElementById('customerRegisterForm').style.opacity = '0.5';
                registerBtn.disabled = true;
                
                showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ù‚Ù… Ø¨ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨', 'success');
                
            } catch (error) {
                console.error('Registration error:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ' + error.message, 'error');
                registerBtn.innerHTML = originalText;
                registerBtn.disabled = false;
            }
        }
        
        function sendVerificationWhatsApp(phone = null) {
            const phoneToVerify = phone || registeredPhone;
            if (!phoneToVerify) return;
            
            const adminNumber = "249918183521"; // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
            const message = "ØªÙØ¹ÙŠÙ„ ØªØ±Ø­Ø§Ù„ Ø²ÙˆÙ†Ø§";
            const whatsappUrl = `https://wa.me/${adminNumber}?text=${encodeURIComponent(message)}`;
            
            window.open(whatsappUrl, '_blank');
            
            showNotification('ØªÙ… ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨. Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ØªØ£ÙƒÙŠØ¯ Ø­Ø³Ø§Ø¨Ùƒ', 'info');
        }
        
        function updateUserProfile() {
            if (!currentUser) return;
            
            document.getElementById('user-avatar').textContent = currentUser.full_name.charAt(0);
            document.getElementById('user-name').textContent = currentUser.full_name;
            document.getElementById('user-phone-display').textContent = currentUser.phone;
            
            // Show verification badge if verified
            if (currentUser.is_verified) {
                document.getElementById('verification-status').classList.remove('hidden');
            }
        }
        
        // --- Driver Functions ---
        async function loginDriver() {
            const phone = document.getElementById('driver-phone').value.trim();
            const password = document.getElementById('driver-password').value;
            
            if (!phone || !password) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
                return;
            }
            
            const loginBtn = document.querySelector('#driverLoginForm button');
            const originalText = loginBtn.innerHTML;
            loginBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...';
            loginBtn.disabled = true;
            
            try {
                const { data: driver, error } = await tarhalDB
                    .from('drivers')
                    .select('*')
                    .eq('whatsapp_number', phone)
                    .eq('is_active', true)
                    .single();
                
                if (error) {
                    showNotification('Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø£Ùˆ Ø§Ù„Ø­Ø³Ø§Ø¨ ØºÙŠØ± Ù…ÙØ¹Ù„', 'error');
                    loginBtn.innerHTML = originalText;
                    loginBtn.disabled = false;
                    return;
                }
                
                if (driver.password !== password) {
                    showNotification('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                    loginBtn.innerHTML = originalText;
                    loginBtn.disabled = false;
                    return;
                }
                
                currentDriver = driver;
                localStorage.setItem('tarhal_driver', JSON.stringify(driver));
                
                showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ Ø£ÙŠÙ‡Ø§ Ø§Ù„Ø³Ø§Ø¦Ù‚!', 'success');
                showScreen('driver-dashboard-screen');
                updateDriverDashboard();
                
            } catch (error) {
                console.error('Driver login error:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„', 'error');
            } finally {
                loginBtn.innerHTML = originalText;
                loginBtn.disabled = false;
            }
        }
        
        function contactAdminForDriverRegistration() {
            const adminNumber = "249918183521"; // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
            const message = "Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø£Ø±ÙŠØ¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙƒØ³Ø§Ø¦Ù‚ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ ØªØ±Ø­Ø§Ù„ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†";
            const whatsappUrl = `https://wa.me/${adminNumber}?text=${encodeURIComponent(message)}`;
            
            window.open(whatsappUrl, '_blank');
            showNotification('ØªÙ… ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', 'info');
        }
        
        async function updateDriverDashboard() {
            if (!currentDriver) return;
            
            document.getElementById('driver-avatar').textContent = currentDriver.full_name.charAt(0);
            document.getElementById('driver-name').textContent = currentDriver.full_name;
            document.getElementById('driver-car-info').textContent = 
                `${currentDriver.car_model || 'Ø³ÙŠØ§Ø±Ø©'} - ${getVehicleTypeName(currentDriver.car_type)}`;
            
            // Update balance
            document.getElementById('driver-balance').textContent = 
                (currentDriver.balance || 0).toLocaleString();
            
            // Fetch today's stats
            try {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const { data: rides, error } = await tarhalDB
                    .from('rides')
                    .select('*')
                    .eq('driver_id', currentDriver.id)
                    .gte('created_at', today.toISOString())
                    .eq('status', 'completed');
                
                if (!error && rides) {
                    const todayEarnings = rides.reduce((sum, ride) => sum + (ride.driver_earnings || 0), 0);
                    document.getElementById('today-trips').textContent = rides.length;
                    document.getElementById('today-earnings').textContent = todayEarnings.toLocaleString();
                }
                
                // Total trips
                const { data: totalRides, error: totalError } = await tarhalDB
                    .from('rides')
                    .select('id')
                    .eq('driver_id', currentDriver.id)
                    .eq('status', 'completed');
                
                if (!totalError && totalRides) {
                    document.getElementById('total-trips').textContent = totalRides.length;
                }
                
            } catch (error) {
                console.error('Error fetching driver stats:', error);
            }
        }
        
        function toggleDriverStatus() {
            isDriverOnline = !isDriverOnline;
            const statusIndicator = document.getElementById('driver-status-indicator');
            const statusText = document.getElementById('driver-status-text');
            const toggleBtn = document.getElementById('toggle-online-btn');
            
            if (isDriverOnline) {
                statusIndicator.className = 'status-indicator status-online';
                statusText.textContent = 'Ù…ØªØµÙ„ ÙˆØ¬Ø§Ù‡Ø²';
                toggleBtn.innerHTML = '<ion-icon name="power-outline"></ion-icon> Ø¥ÙŠÙ‚Ø§Ù ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù…Ù„';
                toggleBtn.classList.add('btn-danger');
                toggleBtn.classList.remove('btn-driver');
                
                startDriverTracking();
                showNotification('Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…ØªØµÙ„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø±ÙƒÙˆØ¨', 'success');
            } else {
                statusIndicator.className = 'status-indicator status-offline';
                statusText.textContent = 'ØºÙŠØ± Ù…ØªØµÙ„';
                toggleBtn.innerHTML = '<ion-icon name="power-outline"></ion-icon> ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù…Ù„';
                toggleBtn.classList.remove('btn-danger');
                toggleBtn.classList.add('btn-driver');
                
                stopDriverTracking();
                showNotification('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù…Ù„', 'info');
            }
        }
        
        function startDriverTracking() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async (position) => {
                    try {
                        await tarhalDB
                            .from('driver_locations')
                            .upsert({
                                driver_id: currentDriver.id,
                                lat: position.coords.latitude,
                                lng: position.coords.longitude,
                                car_type: currentDriver.car_type,
                                last_seen: new Date().toISOString()
                            }, { onConflict: 'driver_id' });
                        
                        showNotification('Ø¨Ø¯Ø£ ØªØªØ¨Ø¹ Ù…ÙˆÙ‚Ø¹Ùƒ...', 'success');
                    } catch (error) {
                        console.error('Tracking error:', error);
                    }
                }, (error) => {
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ', 'error');
                });
            }
        }
        
        function stopDriverTracking() {
            // ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù‡Ù†Ø§ Ù†ÙˆÙ‚Ù ØªØªØ¨Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹
            console.log('Driver tracking stopped');
        }
        
        // --- Ride Functions ---
        function requestRide() {
            if (!currentUser || !currentUser.is_verified) {
                showNotification('ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø·Ù„Ø¨ Ø±Ø­Ù„Ø©', 'error');
                return;
            }
            
            showScreen('ride-request-screen');
            initRideMap();
        }
        
        function initRideMap() {
            if (rideMap) {
                rideMap.remove();
                rideMap = null;
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Leaflet
            rideMap = L.map('ride-map').setView([15.5007, 32.5599], 12);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(rideMap);
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    userPosition = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    
                    rideMap.setView([userPosition.lat, userPosition.lng], 15);
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    userMarker = L.marker([userPosition.lat, userPosition.lng], {
                        icon: L.divIcon({
                            html: '<div style="background: #4f46e5; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>'
                        })
                    }).addTo(rideMap).bindPopup('Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ').openPopup();
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ¬Ù‡Ø©
                    rideMap.on('click', (e) => {
                        setDestination(e.latlng.lat, e.latlng.lng);
                    });
                    
                }, (error) => {
                    showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ', 'warning');
                }, {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                });
            }
        }
        
        function setDestination(lat, lng) {
            destinationPosition = { lat, lng };
            
            if (destinationMarker) {
                destinationMarker.setLatLng([lat, lng]);
            } else {
                destinationMarker = L.marker([lat, lng], {
                    icon: L.divIcon({
                        html: '<div style="background: #ef4444; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>'
                    })
                }).addTo(rideMap).bindPopup('Ù†Ù‚Ø·Ø© Ø§Ù„ÙˆØµÙˆÙ„').openPopup();
                
                // Ø±Ø³Ù… Ø®Ø· Ø¨ÙŠÙ† Ø§Ù„Ù†Ù‚Ø·ØªÙŠÙ†
                if (userMarker) {
                    L.polyline([
                        [userPosition.lat, userPosition.lng],
                        [lat, lng]
                    ], {
                        color: '#4f46e5',
                        weight: 3,
                        opacity: 0.7,
                        dashArray: '10, 10'
                    }).addTo(rideMap);
                }
            }
            
            if (selectedVehicleType) {
                calculateRidePrice();
            }
        }
        
        function selectVehicle(type) {
            selectedVehicleType = type;
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.querySelectorAll('.vehicle-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`.vehicle-option[data-type="${type}"]`).classList.add('selected');
            
            if (destinationPosition) {
                calculateRidePrice();
            }
        }
        
        function calculateRidePrice() {
            if (!userPosition || !destinationPosition || !selectedVehicleType) return;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
            const latDiff = destinationPosition.lat - userPosition.lat;
            const lngDiff = destinationPosition.lng - userPosition.lng;
            const distance = Math.sqrt(latDiff * latDiff + lngDiff * lngDiff) * 111;
            
            const vehicle = VEHICLE_PRICES[selectedVehicleType];
            const additionalKm = Math.max(0, distance - 1);
            const basePrice = vehicle.base;
            const extraPrice = additionalKm * vehicle.perKm;
            const totalPrice = basePrice + extraPrice;
            
            // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø¹Ø±
            document.getElementById('price-calculation').classList.remove('hidden');
            document.getElementById('distance-display').textContent = `${distance.toFixed(1)} ÙƒÙ…`;
            document.getElementById('base-price-display').textContent = `${basePrice.toLocaleString()} SDG`;
            document.getElementById('extra-price-display').textContent = `${extraPrice.toLocaleString()} SDG`;
            document.getElementById('total-price-display').textContent = `${totalPrice.toLocaleString()} SDG`;
            
            document.getElementById('confirm-ride-btn').disabled = false;
        }
        
        async function confirmRide() {
            if (!selectedVehicleType || !destinationPosition) {
                showNotification('Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ¬Ù‡Ø© ÙˆØ§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'warning');
                return;
            }
            
            if (!currentUser || !currentUser.is_verified) {
                showNotification('ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø·Ù„Ø¨ Ø±Ø­Ù„Ø©', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirm-ride-btn');
            const originalText = confirmBtn.innerHTML;
            confirmBtn.innerHTML = '<span class="loading"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¦Ù‚...';
            confirmBtn.disabled = true;
            
            showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¦Ù‚ Ù‚Ø±ÙŠØ¨...', 'info');
            
            try {
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
                const latDiff = destinationPosition.lat - userPosition.lat;
                const lngDiff = destinationPosition.lng - userPosition.lng;
                const distance = Math.sqrt(latDiff * latDiff + lngDiff * lngDiff) * 111;
                const vehicle = VEHICLE_PRICES[selectedVehicleType];
                const additionalKm = Math.max(0, distance - 1);
                const totalPrice = vehicle.base + (additionalKm * vehicle.perKm);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø±Ø­Ù„Ø© ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const { data: ride, error } = await tarhalDB
                    .from('rides')
                    .insert([{
                        customer_id: currentUser.id,
                        customer_name: currentUser.full_name,
                        customer_phone: currentUser.phone,
                        customer_phone2: currentUser.phone2,
                        pickup_lat: userPosition.lat,
                        pickup_lng: userPosition.lng,
                        destination_lat: destinationPosition.lat,
                        destination_lng: destinationPosition.lng,
                        distance_km: parseFloat(distance.toFixed(1)),
                        vehicle_type: selectedVehicleType,
                        amount: totalPrice,
                        status: 'searching',
                        created_at: new Date().toISOString()
                    }])
                    .select()
                    .single();
                
                if (error) throw error;
                
                currentRideId = ride.id;
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¦Ù‚
                setTimeout(() => {
                    showNotification('ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³Ø§Ø¦Ù‚! Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...', 'success');
                    
                    // Ù…Ø­Ø§ÙƒØ§Ø© Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚ Ù„Ù„Ø±Ø­Ù„Ø©
                    setTimeout(() => {
                        showActiveRideModal(ride);
                    }, 2000);
                    
                }, 3000);
                
            } catch (error) {
                console.error('Ride request error:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø·Ù„Ø¨ Ø§Ù„Ø±Ø­Ù„Ø©', 'error');
                confirmBtn.innerHTML = originalText;
                confirmBtn.disabled = false;
            }
        }
        
        function showActiveRideModal(ride) {
            // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø­Ù„Ø©
            const modal = document.getElementById('active-trip-modal');
            modal.classList.remove('hidden');
            
            // Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ø­Ù„Ø©
            const tripDetails = document.getElementById('trip-details');
            tripDetails.innerHTML = `
                <div class="card mb-3">
                    <div class="price-row">
                        <span>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©:</span>
                        <span>${VEHICLE_PRICES[ride.vehicle_type].name}</span>
                    </div>
                    <div class="price-row">
                        <span>Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚:</span>
                        <span>${getNeighborhoodName(ride.pickup_lat, ride.pickup_lng)}</span>
                    </div>
                    <div class="price-row">
                        <span>Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙˆØµÙˆÙ„:</span>
                        <span>${getNeighborhoodName(ride.destination_lat, ride.destination_lng)}</span>
                    </div>
                    <div class="price-row">
                        <span>Ø§Ù„Ù…Ø³Ø§ÙØ©:</span>
                        <span>${ride.distance_km} ÙƒÙ…</span>
                    </div>
                    <div class="price-row">
                        <span>Ø§Ù„Ø³Ø§Ø¦Ù‚:</span>
                        <span>Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯</span>
                    </div>
                    <div class="price-row">
                        <span>Ø±Ù‚Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚:</span>
                        <span>+249 90 123 4567</span>
                    </div>
                    <div class="price-row" style="font-weight: 800; color: var(--primary);">
                        <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
                        <span>${ride.amount.toLocaleString()} SDG</span>
                    </div>
                </div>
                
                <div class="mb-3">
                    <button class="btn btn-secondary" onclick="callDriver()">
                        <ion-icon name="call-outline"></ion-icon>
                        Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³Ø§Ø¦Ù‚
                    </button>
                </div>
                
                <div class="mb-3">
                    <button class="btn btn-danger" onclick="cancelRide()">
                        <ion-icon name="close-outline"></ion-icon>
                        Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©
                    </button>
                </div>
                
                <p style="text-align: center; color: var(--gray); font-size: 14px;">
                    Ø³ÙŠØªÙ… Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø®Ù„Ø§Ù„ Ø«ÙˆØ§Ù†Ù
                </p>
            `;
            
            document.getElementById('confirm-ride-btn').innerHTML = '<ion-icon name="search-outline"></ion-icon> Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¦Ù‚';
            document.getElementById('confirm-ride-btn').disabled = false;
        }
        
        // --- Helper Functions ---
        function getVehicleTypeName(type) {
            const names = {
                tuktuk: 'ØªÙˆÙƒ ØªÙˆÙƒ',
                economy: 'Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©',
                comfort: 'Ù…ØªÙˆØ³Ø·Ø©',
                vip: 'VIP'
            };
            return names[type] || type;
        }
        
        function getNeighborhoodName(lat, lng) {
            // Ø¯Ø§Ù„Ø© Ù…Ø¨Ø³Ø·Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ØªØ³ØªØ®Ø¯Ù… Ø®Ø¯Ù…Ø© Ø¹ÙƒØ³ÙŠØ© Ù„Ù„Ø¬ØºØ±Ø§ÙÙŠØ§)
            return "Ø§Ù„Ø®Ø±Ø·ÙˆÙ…";
        }
        
        function isValidSudanesePhone(phone) {
            // ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙŠØºØ© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠ
            const sudanesePhoneRegex = /^(?:\+249|0)?(?:9[0123456789]|1[012])\d{7}$/;
            return sudanesePhoneRegex.test(phone);
        }
        
        function showNotification(message, type = 'info') {
            const notificationArea = document.getElementById('notification-area');
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            let icon = 'â„¹ï¸';
            if (type === 'success') icon = 'âœ…';
            else if (type === 'error') icon = 'âŒ';
            else if (type === 'warning') icon = 'âš ï¸';
            
            notification.innerHTML = `
                <div class="notification-icon">${icon}</div>
                <div style="flex: 1;">${message}</div>
            `;
            
            notificationArea.appendChild(notification);
            
            // Ø§Ù„Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(-20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        function logout() {
            localStorage.removeItem('tarhal_customer');
            currentUser = null;
            showScreen('welcome-screen');
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
        
        function logoutDriver() {
            if (isDriverOnline) {
                toggleDriverStatus();
            }
            localStorage.removeItem('tarhal_driver');
            currentDriver = null;
            showScreen('welcome-screen');
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„Ø³Ø§Ø¦Ù‚', 'success');
        }
        
        // Placeholder functions for other features
        function showMyRides() {
            showNotification('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©', 'info');
        }
        
        function showWallet() {
            showNotification('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', 'info');
        }
        
        function showSettings() {
            showNotification('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨', 'info');
        }
        
        function showDriverProfile() {
            showNotification('Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ù„Ø³Ø§Ø¦Ù‚', 'info');
        }
        
        function callDriver() {
            showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³Ø§Ø¦Ù‚...', 'info');
        }
        
        function cancelRide() {
            document.getElementById('active-trip-modal').classList.add('hidden');
            showNotification('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø­Ù„Ø©', 'info');
            goHome();
        }
        
        function acceptRide() {
            document.getElementById('incoming-ride-modal').classList.add('hidden');
            showNotification('ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø±Ø­Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
            showActiveRideModal({
                vehicle_type: 'economy',
                amount: 10000,
                distance_km: 5.2
            });
        }
        
        function declineRide() {
            document.getElementById('incoming-ride-modal').classList.add('hidden');
            showNotification('ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø±Ø­Ù„Ø©', 'info');
        }
        
        // Event listeners Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Supabase Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.addEventListener('load', function() {
            // ØªØ­Ù…ÙŠÙ„ Leaflet JS Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø­Ù…Ù„Ø§Ù‹
            if (typeof L === 'undefined') {
                const leafletScript = document.createElement('script');
                leafletScript.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
                leafletScript.onload = function() {
                    console.log('Leaflet loaded successfully');
                };
                document.head.appendChild(leafletScript);
            }
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        if ('Notification' in window) {
            Notification.requestPermission();
        }
// --- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ---
function showCustomerLogin() {
    document.getElementById('welcome-screen').classList.add('hidden');
    document.getElementById('customer-login-screen').classList.remove('hidden');
}

function showDriverLogin() {
    document.getElementById('welcome-screen').classList.add('hidden');
    document.getElementById('driver-login-screen').classList.remove('hidden');
}

function showWelcomeScreen() {
    document.getElementById('customer-login-screen').classList.add('hidden');
    document.getElementById('driver-login-screen').classList.add('hidden');
    document.getElementById('customer-register-screen').classList.add('hidden');
    document.getElementById('driver-register-info-screen').classList.add('hidden');
    document.getElementById('welcome-screen').classList.remove('hidden');
}

function showCustomerRegister() {
    document.getElementById('customer-login-screen').classList.add('hidden');
    document.getElementById('customer-register-screen').classList.remove('hidden');
}

function showDriverRegisterInfo() {
    document.getElementById('driver-login-screen').classList.add('hidden');
    document.getElementById('driver-register-info-screen').classList.remove('hidden');
}
// ğŸ”¥ Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ index.html Ø¯Ø§Ø®Ù„ <script> Ø§Ù„Ø­Ø§Ù„ÙŠ
async function setupPushNotifications() {
  // 1. Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù† Ù…Ù† Ø§Ù„Ø³Ø§Ø¦Ù‚
  const permission = await Notification.requestPermission();
  if (permission !== 'granted') {
    alert('ÙŠØ¬Ø¨ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø±ÙƒÙˆØ¨');
    return;
  }
  
  // 2. Ø³Ø¬Ù„ Service Worker
  await navigator.serviceWorker.register('/firebase-messaging-sw.js');
  
  // 3. Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø±Ù…Ø² Ø§Ù„Ø³Ø§Ø¦Ù‚ (FCM Token)
  const messaging = firebase.messaging();
  const token = await messaging.getToken();
  
  console.log('Ø±Ù…Ø² Ø§Ù„Ø³Ø§Ø¦Ù‚:', token);
  
  // 4. Ø§Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø² ÙÙŠ JSONBin (Ø³ØªØ­ØªØ§Ø¬ Bin Ø¬Ø¯ÙŠØ¯)
  await fetch('https://api.jsonbin.io/v3/b/69470e32ae596e708fa76869', {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      'X-Master-Key': '$2a$10$.o4BAbiMjGS4tEZUVokTsufL18lsFyO30xIOXO8wT4dP/sqGN/61e'
    },
    body: JSON.stringify({
      driverToken: token,
      driverId: currentDriver.id,
      isOnline: true
    })
  });
}

// Ø§Ø³ØªØ¯Ø¹ÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø¹Ù†Ø¯Ù…Ø§ ÙŠØµØ¨Ø­ Ø§Ù„Ø³Ø§Ø¦Ù‚ "Ù…ØªØµÙ„"
function toggleDriverStatus() {
  isDriverOnline = !isDriverOnline;
  
  if (isDriverOnline) {
    setupPushNotifications(); // ğŸ”¥ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‡Ù…
    showNotification('Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…ØªØµÙ„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø±ÙƒÙˆØ¨', 'success');
  }
}
    </script>
</body>
</html>